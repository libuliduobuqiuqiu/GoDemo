## 编译

### 逃逸分析

编译器根据变量是否被外部引用来决定是否逃逸：
1. 如果函数外部没有引用，则必定放在栈中；
2. 如果函数外部存在引用，则必定放在堆中；

> 如果函数返回对一个变量的引用，那么就会发生逃逸；

堆、栈区别？
- 堆适合不可预知大小的内存分配，需要寻找合适的内存碎片进行分配，所以分配速度慢；
- 栈内存分配和释放更快，因为只需要移动栈指针；
- 栈能够被编译器自动清理，堆则需要垃圾回收器清理，垃圾回收会占用比较大的系统开销；

> 通过逃逸分析，尽可能的讲堆上的变量直接分配到栈上，堆上的变量少了，会减轻分配堆内存的开销，减少gc的压力，提高程序的运行速度。


### GoRoot 和 GoPath

GoRoot：
> GoRoot是Go安装目录，编译器和标准库

GoPath：
> GoPath是Go工作区，src存放源文件，bin存放可执行文件，pkg存放源文件编译后的库文件


### Go编译链接过程

源文件到目标可执行文件的过程：
hello.go(源文件) -> 编译器 -> hello.s(汇编程序) -> 汇编器 -> hello.o(可重定位目标程序) -> 链接器 -> hello(可执行目标程序)

编译器编译过程：
词法分析 -> 语法分析 -> 语义分析 -> 优化 -> 生成汇编代码

汇编器将汇编代码转换成机器代码，编译过程是针对单个文件进行，链接器链接过程就是要把编译器生成的一个个目标链接成可执行文件。

